<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PennSIVE Wiki</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">PennSIVE Wiki</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Welcome</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/pennsive/pennsive.github.io">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/PennSIVE/pennsive.github.io/issues/new">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./environments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Environment setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./heudiconv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dicom Conversion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./flywheel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flywheel</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pipelines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PennSIVE pipelines</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducibility</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflows.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nipype workflows</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cluster Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bash_startup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bash Setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RStudio/Jupyter Lab on Cluster</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gpu-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GPU Computing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rpackages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro to Python</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contributing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contributing to this Wiki</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pennsive_neuro_pip" id="toc-pennsive_neuro_pip" class="nav-link active" data-scroll-target="#pennsive_neuro_pip">PennSIVE_neuro_pip</a>
  <ul class="collapse">
  <li><a href="#bids" id="toc-bids" class="nav-link" data-scroll-target="#bids">BIDS</a>
  <ul class="collapse">
  <li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage">Usage</a></li>
  </ul></li>
  <li><a href="#mimosa" id="toc-mimosa" class="nav-link" data-scroll-target="#mimosa">MIMoSA</a>
  <ul class="collapse">
  <li><a href="#usage-1" id="toc-usage-1" class="nav-link" data-scroll-target="#usage-1">Usage</a></li>
  </ul></li>
  <li><a href="#cvs" id="toc-cvs" class="nav-link" data-scroll-target="#cvs">CVS</a>
  <ul class="collapse">
  <li><a href="#usage-2" id="toc-usage-2" class="nav-link" data-scroll-target="#usage-2">Usage</a></li>
  </ul></li>
  <li><a href="#aprl" id="toc-aprl" class="nav-link" data-scroll-target="#aprl">APRL</a>
  <ul class="collapse">
  <li><a href="#usage-3" id="toc-usage-3" class="nav-link" data-scroll-target="#usage-3">Usage</a></li>
  </ul></li>
  <li><a href="#lesion-count" id="toc-lesion-count" class="nav-link" data-scroll-target="#lesion-count">Lesion Count</a>
  <ul class="collapse">
  <li><a href="#usage-4" id="toc-usage-4" class="nav-link" data-scroll-target="#usage-4">Usage</a></li>
  </ul></li>
  <li><a href="#radiomic-feature" id="toc-radiomic-feature" class="nav-link" data-scroll-target="#radiomic-feature">Radiomic Feature</a>
  <ul class="collapse">
  <li><a href="#usage-5" id="toc-usage-5" class="nav-link" data-scroll-target="#usage-5">Usage</a></li>
  </ul></li>
  <li><a href="#t1t2" id="toc-t1t2" class="nav-link" data-scroll-target="#t1t2">T1/T2</a>
  <ul class="collapse">
  <li><a href="#usage-6" id="toc-usage-6" class="nav-link" data-scroll-target="#usage-6">Usage</a></li>
  </ul></li>
  <li><a href="#freesurfer" id="toc-freesurfer" class="nav-link" data-scroll-target="#freesurfer">FreeSurfer</a>
  <ul class="collapse">
  <li><a href="#usage-7" id="toc-usage-7" class="nav-link" data-scroll-target="#usage-7">Usage</a></li>
  </ul></li>
  <li><a href="#jlf" id="toc-jlf" class="nav-link" data-scroll-target="#jlf">JLF</a>
  <ul class="collapse">
  <li><a href="#usage-8" id="toc-usage-8" class="nav-link" data-scroll-target="#usage-8">Usage</a></li>
  </ul></li>
  <li><a href="#skullstripping" id="toc-skullstripping" class="nav-link" data-scroll-target="#skullstripping">Skullstripping</a>
  <ul class="collapse">
  <li><a href="#usage-9" id="toc-usage-9" class="nav-link" data-scroll-target="#usage-9">Usage</a></li>
  </ul></li>
  <li><a href="#brainqc" id="toc-brainqc" class="nav-link" data-scroll-target="#brainqc">BrainQC</a>
  <ul class="collapse">
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation">Installation</a></li>
  <li><a href="#usage-10" id="toc-usage-10" class="nav-link" data-scroll-target="#usage-10">Usage</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="pennsive_neuro_pip" class="level1">
<h1>PennSIVE_neuro_pip</h1>
<p>There are multiple pipelines available through the <a href="https://github.com/PennSIVE/PennSIVE_neuro_pip">PennSIVE_neuro_pip repo</a> to facilitate MRI processing. This article will walk you through instructions and examples for using each of them.</p>
<p>For each pipeline, usage instructions will be provided with dummy paths and an example path. Clicking the pipeline name will take you to the respective pipeline’s GitHub page.</p>
<p>Note, these pipelines are also available as BIDS apps, with instructions on the <a href="https://pennsive.github.io/pipelines.html">PennSIVE pipelines page</a>.</p>
<section id="bids" class="level2">
<h2 class="anchored" data-anchor-id="bids"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/bids">BIDS</a></h2>
<p>The BIDS pipeline converts DICOM images to NIfTI and organizes the files in BIDS format. It uses the heudiconv DICOM converter and an RShiny app for heuristic customization.</p>
<section id="usage" class="level3">
<h3 class="anchored" data-anchor-id="usage">Usage</h3>
<p>This pipeline contains three stages: 1) Heuristic: prepares heuristic template, 2) Customization: launches RShiny app for heuristic customization, and 3) BIDS: runs DICOM to NIfTI conversion and format into BIDS structure.</p>
<p>This pipeline must be run through a container, either Singularity on a cluster or Docker locally. Steps 1 and 3 can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively. Step 2 must be run in batch mode.</p>
<p>These examples will run the pipeline in batch mode on the cluster via Singularity. To run individually or locally with Docker, set <code>--mode individual</code>, or <code>-c docker</code>, respectively.</p>
<section id="step-1.-heuristic" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-heuristic"><u>Step 1. Heuristic</u></h4>
<p>This step prepares the heuristic file by copying the template to a template folder, as well as each subject and session folder. These files will be edited in Step 2: Customization.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - heuristic, customization, bids. Default is heuristic<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is individual<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker. Default is docker<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/bids/code/bash/bids_curation.sh <span class="at">-m</span> /path/to/project <span class="at">--mode</span> batch <span class="at">-c</span> singularity <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/bids/code/bash/bids_curation.sh <span class="at">-m</span> /home/ehorwath/projects/test_data <span class="at">--mode</span> batch <span class="at">-c</span> singularity <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-customization" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-customization"><u>Step 2. Customization</u></h4>
<p>In this step, an RShiny app will launch to customize the heuristic template created in the last step. **This step only runs in batch mode and does not need a container specification. If you are unable to connect to the app from your terminal, try running this step in VSCode.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - heuristic, customization, bids. Default is heuristic. This step is customization<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/bids/code/bash/bids_curation.sh <span class="at">-m</span> /path/to/project <span class="at">--step</span> customization <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/bids/code/bash/bids_curation.sh <span class="at">-m</span> /home/ehorwath/projects/test_data <span class="at">--step</span> customization <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p><strong>Using the app:</strong></p>
<p>The Shiny app allows you to edit the heuristic file for all subjects in the original_data folder or for each subject individually.</p>
<p>To begin, under Choose Python Script, load in the heuristic.py file in the template folder.</p>
<p>To review each subjects’ DICOM info and edit the heuristic on a <strong>subject-level basis</strong>, the DICOM Info Review will load each subject’s info by clicking Next and Previous in the DICOM Selection. Edits can be made in the Update Heuristic Script section and finalized by clicking <strong>Update Script</strong>.</p>
<p><strong>Group-level changes</strong> to the heuristic can be made by edits to the Update Heuristic Script section, and when finished, clicking <strong>Update All Scripts</strong>. This will apply those changes to all subjects in the folder.</p>
<p><br></p>
</section>
<section id="step-3.-bids" class="level4">
<h4 class="anchored" data-anchor-id="step-3.-bids"><u>Step 3. BIDS</u></h4>
<p>This step runs DICOM to NIfTI conversion and format into BIDS structure based on the heuristic files edited in Step 2.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - heuristic, customization, bids. Default is heuristic. This step is bids<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is individual<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker. Default is docker<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/bids/code/bash/bids_curation.sh <span class="at">-m</span> /path/to/project <span class="at">--step</span> bids <span class="at">--mode</span> batch <span class="at">-c</span> singularity <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/bids/code/bash/bids_curation.sh <span class="at">-m</span> /home/ehorwath/projects/test_data <span class="at">--step</span> bids <span class="at">--mode</span> batch <span class="at">-c</span> singularity <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p><br> <br></p>
</section>
</section>
</section>
<section id="mimosa" class="level2">
<h2 class="anchored" data-anchor-id="mimosa"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/mimosa">MIMoSA</a></h2>
<p>The MIMoSA pipeline integrates an automated technique for white matter lesion segmentation. It provides processed T1-weighted and T2-FLAIR images, as well as a white matter lesion mask. (The current pipeline uses a pre-trained MIMoSA model, which was trained using 3T T1-weighted and T2-FLAIR images as the input).</p>
<section id="usage-1" class="level3">
<h3 class="anchored" data-anchor-id="usage-1">Usage</h3>
<p>This pipeline processes raw T1 and T2-FLAIR images to segment white matter lesions. By default, it runs bias correction, registration to FLAIR space, WhiteStripe normalization, and MIMoSA. Skullstripping can be turned on if input images contain non-brain tissue.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-f or --flair</span>: FLAIR sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--t2</span>: T2 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --n4</span>: run N4 bias correction. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --skullstripping</span>: run skullstripping. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-r or --registration</span>: run registration. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-w or --whitestripe</span>: run WhiteStripe normalization. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--threshold</span>: threshold for generating mimosa mask. Default is 0.2<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/mimosa/code/bash/mimosa.sh <span class="at">-m</span> /path/to/data <span class="at">-t</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">-f</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/mimosa/code/bash/mimosa.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--t1</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--flair</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
<section id="cvs" class="level2">
<h2 class="anchored" data-anchor-id="cvs"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/cvs">CVS</a></h2>
<p>The CVS pipeline integrates an automated technique for the detection of the central vein sign in white matter lesions. It provides processed T1-weighted, T2-FLAIR, and T2*-EPI images, as well as subject-level CVS probabilities.</p>
<section id="usage-2" class="level3">
<h3 class="anchored" data-anchor-id="usage-2">Usage</h3>
<p>This pipeline contains three stages: 1) Preprocessing and CVS Probability Calculation: calculates the probability of each participant’s probability of having cvs lesions, and 2) Consolidation: consolidates all participants’ CVS results.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively. Only Steps 1 and 2 have the option of individual or batch; Step 3 will always run in batch mode.</p>
<p><br></p>
<section id="step-1.-preprocessing-cvs-probability-calculation" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-preprocessing-cvs-probability-calculation"><u>Step 1. Preprocessing &amp; CVS Probability Calculation</u></h4>
<p>This step processes raw T1, T2-FLAIR, and T2*-EPI images to prepare for CVS probability calculation. By default, it runs bias correction, registration to FLAIR space, WhiteStripe normalization, MIMoSA, CSF extraction, splitting confluent lesions, registration to EPI space, and CVS score calculation. Skullstripping can be turned on if input images contain non-brain tissue.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-f or --flair</span>: FLAIR sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-e or --epi</span>: EPI sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --n4</span>: run N4 bias correction. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --skullstripping</span>: run skullstripping. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-r or --registration</span>: run registration. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-w or --whitestripe</span>: run WhiteStripe normalization. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--mimosa</span>: run MIMoSA segmentation. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--threshold</span>: threshold for generating MIMoSA mask. Default is 0.2<br> <span style="font-family:menlo; color:black; font-size:16px;">--csf</span>: extract CSF mask. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - estimation, consolidation. Default is estimation<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/cvs/code/bash/cvs.sh <span class="at">-m</span> /path/to/data <span class="at">-t</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">-f</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">-e</span> <span class="st">"*T2star.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/cvs/code/bash/cvs.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--t1</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--flair</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">--epi</span> <span class="st">"*EPI*.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-consolidation" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-consolidation"><u>Step 2. Consolidation</u></h4>
<p>This step consolidates the CVS results for all participants and sessions.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - estimation, consolidation. Default is estimation. This step is consolidation<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/cvs/code/bash/cvs.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/cvs/code/bash/cvs.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="aprl" class="level2">
<h2 class="anchored" data-anchor-id="aprl"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/PRL">APRL</a></h2>
<p>The APRL pipeline integrates an automated technique for paramagnetic rim lesion (PRL) detection. It provides processed T1-weighted, T2-FLAIR, and T2star-Phase images, as well as white matter lesion masks and the probability of each lesion being a PRL. (The current pipeline uses a pre-trained MIMoSA model and APRL model).</p>
<section id="usage-3" class="level3">
<h3 class="anchored" data-anchor-id="usage-3">Usage</h3>
<p>This pipeline contains three stages: 1) Preprocessing: processes MRI images to prepare for PRL probability calculation, 2) PRL Probability Calculation: calculates the probability of each lesion being a PRL, and 3) Consolidation: consolidates all participants’ PRL results.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively. Only Steps 1 and 2 have the option of individual or batch; Step 3 will always run in batch mode.</p>
<p><br></p>
<section id="step-1.-preprocessing" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-preprocessing"><u>Step 1. Preprocessing</u></h4>
<p>This step processes raw T1, T2-FLAIR, and T2*-PHASE images to prepare for PRL probability calculation. By default, it runs bias correction, registration to FLAIR space, WhiteStripe normalization, MIMoSA, registration to EPI space, lesion dilation, and splitting and labeling of confluent lesions. Skullstripping can be turned on if input images contain non-brain tissue.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-f or --flair</span>: FLAIR sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--phase</span>: PHASE sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --n4</span>: run N4 bias correction. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --skullstripping</span>: run skullstripping. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-r or --registration</span>: run registration. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-w or --whitestripe</span>: run WhiteStripe normalization. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--mimosa</span>: run MIMoSA segmentation. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--threshold</span>: threshold for generating MIMoSA mask. Default is 0.2<br> <span style="font-family:menlo; color:black; font-size:16px;">--dilation</span>: dilate lesion. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - preparation, PRL_run, consolidation. Default is preparation<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/PRL/code/bash/PRL <span class="at">-m</span> /path/to/data <span class="at">-t</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">-f</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">--phase</span> <span class="st">"*UNWRAPPED*.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/PRL/code/bash/PRL.sh <span class="at">-m</span> /home/ehorwath/projects/prl <span class="at">--t1</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">--flair</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">--phase</span> <span class="st">"*UNWRAPPED*.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-prl-probability-calculation" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-prl-probability-calculation"><u>Step 2. PRL Probability Calculation</u></h4>
<p>This step calculates the probability of each lesion being a PRL from the preprocessed images.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - preparation, PRL_run, consolidation. Default is preparation. This step is PRL_run<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/PRL/code/bash/PRL.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> PRL_run <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/PRL/code/bash/PRL.sh <span class="at">-m</span> /home/ehorwath/projects/prl <span class="at">--step</span> PRL_run <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-3.-consolidation" class="level4">
<h4 class="anchored" data-anchor-id="step-3.-consolidation"><u>Step 3. Consolidation</u></h4>
<p>This step consolidates the PRL results for all participants and sessions.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - preparation, PRL_run, consolidation. Default is preparation. This step is consolidation<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/PRL/code/bash/PRL.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/PRL/code/bash/PRL.sh <span class="at">-m</span> /home/ehorwath/projects/prl <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="lesion-count" class="level2">
<h2 class="anchored" data-anchor-id="lesion-count"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/lesion_count">Lesion Count</a></h2>
<p>The lesion_count pipeline provides two options to count the number of lesions present in MRI images using the “DworCount” method, developed by Dr.&nbsp;Jordan Dworkin and the connected components method.</p>
<section id="usage-4" class="level3">
<h3 class="anchored" data-anchor-id="usage-4">Usage</h3>
<p>The pipeline allows for three count options: DworCount (set –method dworcount), connected components (set –method cc), or both (default; set –method both).</p>
<p>This pipeline contains three stages: 1) Preparation: preprocesses and prepares data for lesion counting, 2) Count: counts number of lesions using specified method, 3) Consolidation: consolidates all participants’ results into a single .csv file.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively.</p>
<p><br></p>
<section id="step-1.-preparation" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-preparation"><u>Step 1. Preparation</u></h4>
<p>This step processes raw T1 and T2-FLAIR images to prepare for lesion counting. By default, it runs bias correction, registration to FLAIR space, WhiteStripe normalization, and MIMoSA. For the DworCount method, confluent lesions are split and labeled. Skullstripping can be turned on if input images contain non-brain tissue.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-f or --flair</span>: FLAIR sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --n4</span>: run N4 bias correction. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --skullstripping</span>: run skullstripping. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-r or --registration</span>: run registration. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-w or --whitestripe</span>: run WhiteStripe normalization. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--mimosa</span>: run MIMoSA segmentation. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--threshold</span>: threshold for generating MIMoSA mask. Default is 0.2<br> <span style="font-family:menlo; color:black; font-size:16px;">--method</span>: cc, dworcount, both. Default is both<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - preparation, count, consolidation. Default is preparation<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/lesion_count/code/bash/lesion_count.sh <span class="at">-m</span> /path/to/data <span class="at">-t</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">-f</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/lesion_count/code/bash/lesion_count.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--t1</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">--flair</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">-s</span> TRUE <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-count" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-count"><u>Step 2. Count</u></h4>
<p>This step counts lesions based on connected components or DworCount method.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - preparation, count, consolidation. Default is preparation. This step is count<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--method</span>: cc, dworcount, both. Default is both<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/lesion_count/code/bash/lesion_count.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> count <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/lesion_count/code/bash/lesion_count.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> count <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-3.-consolidation-1" class="level4">
<h4 class="anchored" data-anchor-id="step-3.-consolidation-1"><u>Step 3. Consolidation</u></h4>
<p>This step consolidates the lesion counts for all participants and sessions.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - preparation, count, consolidation. Default is preparation. This step is consolidation<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">--method</span>: cc, dworcount, both. Default is both<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/lesion_count/code/bash/lesion_count.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/lesion_count/code/bash/lesion_count.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="radiomic-feature" class="level2">
<h2 class="anchored" data-anchor-id="radiomic-feature"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/radiomic_feature">Radiomic Feature</a></h2>
<p>The lesion radiomic feature extraction pipeline utilizes PyRadiomics to extract lesion features from T1-weighted, T2-FLAIR, and T2*-EPI images.</p>
<section id="usage-5" class="level3">
<h3 class="anchored" data-anchor-id="usage-5">Usage</h3>
<p>The pipeline contains three stages: 1) Preprocessing: processes MRI images to prepare for radiomic feature extraction, 2) Feature Extraction: extract radiomic features using PyRadiomics package, and 3) Consolidation: consolidates all participants’ lesion radiomic feature data.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively.</p>
<p><br></p>
<section id="step-1.-processing" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-processing"><u>Step 1. Processing</u></h4>
<p>This step processes raw T1, T2-FLAIR, and T2*-EPI images to prepare for extraction of radiomic features. By default, it runs bias correction, registration to FLAIR space, WhiteStripe normalization, MIMoSA, CSF extraction, splitting confluent lesions, and registration to EPI space. Skullstripping can be turned on if input images contain non-brain tissue.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-f or --flair</span>: FLAIR sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-e or --epi</span>: EPI sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --n4</span>: run N4 bias correction. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --skullstripping</span>: run skullstripping. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-r or --registration</span>: run registration. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">-w or --whitestripe</span>: run WhiteStripe normalization. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--mimosa</span>: run MIMoSA segmentation. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--threshold</span>: threshold for generating MIMoSA mask. Default is 0.2<br> <span style="font-family:menlo; color:black; font-size:16px;">--csf</span>: extract CSF mask. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - processing, extraction, consolidation. Default is processing<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/radiomic_feature/code/bash/pyradiomics.sh <span class="at">-m</span> /path/to/project <span class="at">-t</span> <span class="st">"*_T1w.nii.gz"</span> <span class="at">-f</span> <span class="st">"*_FLAIR.nii.gz"</span> <span class="at">-e</span> <span class="st">"*_T2star.nii.gz"</span> <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/radiomic_feature/code/bash/pyradiomics.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--t1</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--flair</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">--epi</span> <span class="st">"*EPI*.nii.gz"</span> <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-feature-extraction" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-feature-extraction"><u>Step 2. Feature Extraction</u></h4>
<p>This step extracts radiomic features.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - processing, extraction, consolidation. Default is preparation. This step is extraction<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/radiomic_feature/code/bash/pyradiomics.sh <span class="at">-m</span> /path/to/project <span class="at">--step</span> extraction <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/radiomic_feature/code/bash/pyradiomics.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> extraction <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-3.-consolidation-2" class="level4">
<h4 class="anchored" data-anchor-id="step-3.-consolidation-2"><u>Step 3. Consolidation</u></h4>
<p>This step consolidates the radiomic features for all participants and sessions.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - processing, extraction, consolidation. Default is preparation. This step is consolidation<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/radiomic_feature/code/bash/pyradiomics.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/radiomic_feature/code/bash/pyradiomics.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="t1t2" class="level2">
<h2 class="anchored" data-anchor-id="t1t2"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/t1t2">T1/T2</a></h2>
<p>The T1T2 pipeline generates the ratio of T1-weighted to T2-weighted signal intensity (T1/T2). The T2 sequence can be specified as a T2-weighted or FLAIR (default) image.</p>
<section id="usage-6" class="level3">
<h3 class="anchored" data-anchor-id="usage-6">Usage</h3>
<p>The pipeline contains two stages: 1) Estimation: calculates each participants’ T1/T2 ratio and 2) Consolidation: consolidates all participants’ results into a single .csv file.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively.</p>
<p><br></p>
<section id="step-1.-estimation" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-estimation"><u>Step 1. Estimation</u></h4>
<p>This step processes T1 and T2 or T2-FLAIR (default) images to estimate the T1/T2 ratio. By default, it extracts lesion volumes and generation of T1/T2 ratio. This is different from most other pipelines that run all preprocessing steps by default. Bias correction, skullstripping, registration to FLAIR or T2 space, WhiteStripe normalization can be turned on if required.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--t2</span>: T2 sequence name<br> OR<br> <span style="font-family:menlo; color:black; font-size:16px;">-f or --flair</span>: FLAIR sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --n4</span>: run N4 bias correction. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --skullstripping</span>: run skullstripping. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-r or --registration</span>: run registration. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-w or --whitestripe</span>: run WhiteStripe normalization. Default is FALSE<br> <span style="font-family:menlo; color:black; font-size:16px;">-l or --lesion</span>: extract lesion volumes. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--t2type</span>: T2 sequence for generating T1/T2 ratio - t2, flair. Default is flair<br> <span style="font-family:menlo; color:black; font-size:16px;">--masktype</span>: segmentation for generating ROI T1/T2 - fast, jlf, freesurfer. Default is freesurfer<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - estimation, consolidation. Default is estimation<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/t1t2/code/bash/t1t2.sh <span class="at">-m</span> /path/to/project <span class="at">--t1</span> <span class="st">"*T1w.nii.gz"</span> <span class="at">-f</span> <span class="st">"*FLAIR.nii.gz"</span> <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/t1t2/code/bash/t1t2.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--t1</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--flair</span> <span class="st">"*FLAIR*.nii.gz"</span> <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-consolidation-1" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-consolidation-1"><u>Step 2. Consolidation</u></h4>
<p>This step consolidates the T1/T2 ratios for all participants and sessions.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - estimation, consolidation. Default is estimation. This step is consolidation<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">--t2type</span>: T2 sequence for generating T1/T2 ratio - t2, flair. Default is flair<br> <span style="font-family:menlo; color:black; font-size:16px;">--masktype</span>: segmentation for generating ROI T1/T2 - fast, jlf, freesurfer. Default is freesurfer<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/t1t2/code/bash/t1t2.sh <span class="at">-m</span> /path/to/project <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/t1t2/code/bash/t1t2.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="freesurfer" class="level2">
<h2 class="anchored" data-anchor-id="freesurfer"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/freesurfer">FreeSurfer</a></h2>
<p>The FreeSurfer pipeline integrates <a href="https://surfer.nmr.mgh.harvard.edu/fswiki">FreeSurfer</a> software to provide a full processing stream for structural MRI data. It takes a T1-weighted image as the only input and generates brain ROI segmentation masks as well as brain-related statistics.</p>
<section id="usage-7" class="level3">
<h3 class="anchored" data-anchor-id="usage-7">Usage</h3>
<p>This pipeline contains three stages: 1) Segmentation: runs the FreeSurfer recon-all command to obtain ROI segmentation masks and brain statistics, 2) Estimation: converts the brain statistics into CSV format, and 3) Consolidation: consolidates all participants’ data.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively. Only Steps 1 and 2 have the option of individual or batch; Step 3 will always run in batch mode.</p>
<p><br></p>
<section id="step-1.-segmentation" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-segmentation"><u>Step 1. Segmentation</u></h4>
<p>This step runs FreeSurfer’s recon-all command on a T1 image to obtain ROI segmentation masks and brain statistics.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --name</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --step</span>: step of pipeline - segmentation, estimation, consolidation. Default is segmentation<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/freesurfer/code/bash/freesurfer.sh <span class="at">-m</span> /path/to/data <span class="at">-n</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/freesurfer/code/bash/freesurfer.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">-n</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-estimation" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-estimation"><u>Step 2. Estimation</u></h4>
<p>This step converts the brain statistics output from Step 1 and converts to CSV format.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --step</span>: step of pipeline - segmentation, estimation, consolidation. Default is segmentation<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--parc</span>: parcellation - aparc, aparc.a2009s. Default is aparc<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/freesurfer/code/bash/freesurfer.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> estimation <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/freesurfer/code/bash/freesurfer.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> estimation <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-3.-consolidation-3" class="level4">
<h4 class="anchored" data-anchor-id="step-3.-consolidation-3"><u>Step 3. Consolidation</u></h4>
<p>This step consolidates the brain statistics for all participants and sessions.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/freesurfer/code/bash/freesurfer.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/freesurfer/code/bash/freesurfer.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> consolidation <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="jlf" class="level2">
<h2 class="anchored" data-anchor-id="jlf"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/JLF">JLF</a></h2>
<p>The JLF pipeline produces a high-resolution anatomical segmentation using the ANTs Joint Label Fusion algorithm. A T1-weighted image is the only input needed.</p>
<section id="usage-8" class="level3">
<h3 class="anchored" data-anchor-id="usage-8">Usage</h3>
<p>The pipeline contains three stages: 1) Registration: registers atlas into participants’ T1-weighted space, 2) antsjointfusion: segments T1 images using multi-atlas segmentation with joint label fusion, 3) Extraction: extracts ROI and lesion volumes.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively. Only Steps 1 and 2 have the option of individual or batch; Step 3 will always run in batch mode.</p>
<p><br></p>
<section id="step-1.-registration" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-registration"><u>Step 1. Registration</u></h4>
<p>This step registers the selected atlas to the subjects’ native T1 space.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --step</span>: step of pipeline - registration, antsjointfusion, extraction. Default is antsjointfusion. This step is registration<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --num</span>: number of templates. Default is 9<br> <span style="font-family:menlo; color:black; font-size:16px;">--type</span>: type of templates - WMGM, thal. Default is WMGM<br> <span style="font-family:menlo; color:black; font-size:16px;">--lesion</span>: extract lesion volumes. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/JLF/code/bash/JLF.sh <span class="at">-m</span> /path/to/project <span class="at">--t1</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">--step</span> registration <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/JLF/code/bash/JLF.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--t1</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--step</span> registration <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-antsjointfusion" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-antsjointfusion"><u>Step 2. antsJointFusion</u></h4>
<p>This step runs the antsJointFusion function from ANTs.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --t1</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --num</span>: number of templates. Default is 9<br> <span style="font-family:menlo; color:black; font-size:16px;">--type</span>: type of templates - WMGM, thal. Default is WMGM<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --step</span>: step of pipeline - registration, antsjointfusion, extraction. Default is antsjointfusion<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/JLF/code/bash/JLF.sh <span class="at">-m</span> /path/to/project <span class="at">--t1</span> <span class="st">"*T1w*.nii.gz"</span> <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/JLF/code/bash/JLF.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--t1</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-3.-extraction" class="level4">
<h4 class="anchored" data-anchor-id="step-3.-extraction"><u>Step 3. Extraction</u></h4>
<p>This step extracts ROI and lesion volumes for all participants and sessions.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-s or --step</span>: step of pipeline - registration, antsjointfusion, extraction. Default is antsjointfusion. This step is extraction<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--type</span>: type of templates - WMGM, thal. Default is WMGM<br> <span style="font-family:menlo; color:black; font-size:16px;">--lesion</span>: extract lesion volumes. Default is TRUE<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/JLF/code/bash/JLF.sh <span class="at">-m</span> /path/to/project <span class="at">--step</span> extraction <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/JLF/code/bash/JLF.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">--step</span> extraction <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
</section>
<section id="skullstripping" class="level2">
<h2 class="anchored" data-anchor-id="skullstripping"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/skullstripping">Skullstripping</a></h2>
<p>The skullstripping pipeline provides several options (MASS and HD-BET) to remove skull and non-brain matter from brain images.</p>
<section id="usage-9" class="level3">
<h3 class="anchored" data-anchor-id="usage-9">Usage</h3>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. This pipeline can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively.</p>
<p>The pipeline allows for two skullstripping options: mass (default) and hdbet. To use hdbet, set -t “hdbet”.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-f or --file</span>: T1 sequence name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--ses</span>: session ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --type</span>: skullstripping method - mass, hdbet. Default is mass<br> <span style="font-family:menlo; color:black; font-size:16px;">-n or --number</span>: number of templates. Default is 20<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/skullstripping/code/bash/skullstripping.sh <span class="at">-m</span> /path/to/project <span class="at">-f</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/skullstripping/code/bash/skullstripping.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">-f</span> <span class="st">"*MPRAGE*.nii.gz"</span> <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>
</section>
</section>
<section id="brainqc" class="level2">
<h2 class="anchored" data-anchor-id="brainqc"><a href="https://github.com/PennSIVE/PennSIVE_neuro_pip/tree/main/pipelines/BrainQC">BrainQC</a></h2>
<p>This pipeline contains the Brain WM Lesion/ROI Segmentation QC Shiny App, a collaborative tool designed to facilitate the evaluation of white matter lesion masks generated by segmentation algorithms like MIMoSA, brain ROI masks generated by JLF and FreeSurfer, as well as lesion center masks for CVS score calculation and PRL lesion masks for PRL score calculation. It provides a user-friendly interface where multiple users can collectively assess segmentation quality through interactive features.</p>
<section id="installation" class="level3">
<h3 class="anchored" data-anchor-id="installation">Installation</h3>
<p>Cluster:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">CURL_CA_BUNDLE =</span> <span class="st">"/etc/ssl/certs/ca-bundle.trust.crt"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>new_path <span class="ot">=</span> <span class="st">"/path/to/save/r_packages"</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># for example:</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># new_path = "/home/ehorwath/rpackages"</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_libpaths</span>(<span class="at">new =</span> new_path, <span class="fu">install_github</span>(<span class="st">"Zheng206/BrainQC"</span>))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># change the QC_CLI.R Script</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">.libPaths</span>(<span class="fu">c</span>(<span class="st">"/misc/appl/R-4.1/lib64/R/library"</span>,new_path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Local:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>new_path <span class="ot">=</span> <span class="st">"/path/to/save/r_packages"</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for example:</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># new_path = "/home/ehorwath/rpackages"</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_libpaths</span>(<span class="at">new =</span> new_path, <span class="fu">install_github</span>(<span class="st">"Zheng206/BrainQC"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="usage-10" class="level3">
<h3 class="anchored" data-anchor-id="usage-10">Usage</h3>
<p>This pipeline contains three stages: 1) QC Preparation: prepares for QC results, 2) Interactive Evaluation: runs interactive QC sessions to evaluate segmentation masks, and 3) Post-QC: reviews QC results interactively.</p>
<p>This pipeline can be run with or without a container. For containerized usage, Singularity can be used on a cluster or Docker locally. Step 1 can be run in individual or batch mode, meaning you can specify a certain subject and session or run the pipeline for all subjects in the folder, respectively. Steps 2 and 3 must be run in batch mode.</p>
<p>These examples will run the pipeline in batch mode on the cluster. To run individually or locally/with a container, set <code>--mode -individual</code>, or <code>-c local</code>/<code>-c singularity</code>/<code>-c docker</code>, respectively.</p>
<p><br></p>
<section id="step-1.-qc-preparation" class="level4">
<h4 class="anchored" data-anchor-id="step-1.-qc-preparation"><u>Step 1. QC Preparation</u></h4>
<p>This step prepares all data for QC app.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-i or --img</span>: brain image name<br> <span style="font-family:menlo; color:black; font-size:16px;">--seg</span>: ROI or lesion mask name<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-p or --participant</span>: participant ID (only needed for individual mode)<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - prep, qc, post. Default is prep<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --type</span>: type of QC procedure - lesion, cvs, freesurfer, JLF, PRL. Default is lesion<br> <span style="font-family:menlo; color:black; font-size:16px;">--defaultseg</span>: default ROI to be evaluated first (only needed if type is freesurfer or JLF)<br> <span style="font-family:menlo; color:black; font-size:16px;">--mode</span>: run pipeline individually or batch. Default is batch<br> <span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">--cores</span>: number of cores used for parallel computing. Default is 1<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<p>Lesion QC</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /path/to/data <span class="at">-i</span> flair_n4_brain.nii.gz <span class="at">--seg</span> mimosa_mask.nii.gz <span class="at">-t</span> lesion <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>For example:</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras_defaced_regSites <span class="at">-i</span> flair_n4_brain_ses.nii.gz <span class="at">--seg</span> mimosa_mask.nii.gz <span class="at">-t</span> lesion <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p>FreeSurfer QC</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /path/to/data <span class="at">-i</span> ^brain.mgz <span class="at">--seg</span> ^aseg.mgz <span class="at">-t</span> freesurfer <span class="at">--defaultseg</span> choroid-plexus <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>For example:</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">-i</span> ^brain.mgz <span class="at">--seg</span> ^aseg.mgz <span class="at">-t</span> freesurfer <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p>JLF QC</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /path/to/data <span class="at">-i</span> <span class="st">"*t1_brain.nii.gz"</span> <span class="at">--seg</span> fused_WMGM_seg.nii.gz <span class="at">-t</span> JLF <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>For example:</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">-i</span> <span class="st">"*t1w_brain.nii.gz"</span> <span class="at">--seg</span> fused_WMGM_seg.nii.gz <span class="at">-t</span> JLF <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p>CVS QC</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /path/to/data <span class="at">-i</span> epi_n4_brain.nii.gz <span class="at">--seg</span> les_reg_epi.nii.gz <span class="at">-t</span> cvs <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>For example:</li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras <span class="at">-i</span> epi_n4_brain.nii.gz <span class="at">--seg</span> les_reg_epi.nii.gz <span class="at">-t</span> cvs <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p>PRL QC</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /path/to/data <span class="at">-i</span> phase_n4_brain.nii.gz <span class="at">--seg</span> lesions_reg_epi_labeled.nii.gz <span class="at">-t</span> PRL <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>For example:</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /home/ehorwath/projects/prl <span class="at">-i</span> phase_n4_brain.nii.gz <span class="at">--seg</span> lesions_reg_epi_labeled.nii.gz <span class="at">-t</span> PRL <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-2.-interactive-evaluation" class="level4">
<h4 class="anchored" data-anchor-id="step-2.-interactive-evaluation"><u>Step 2. Interactive Evaluation</u></h4>
<p>This step runs the QC app to evaluate accuarcy of segmentation masks with processed images.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">-t or --type</span>: type of QC procedure - lesion, cvs, freesurfer, JLF, PRL. Default is lesion<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - prep, qc, post. Default is prep. This step is qc<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">--cores</span>: number of cores used for parallel computing. Default is 1<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<p>For this step, the only flag that will differ across QC types is <code>-t or --type</code>. Be sure to use the same type as Step 1.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> qc <span class="at">-t</span> lesion <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example (Lesion QC):</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras_defaced_regSites <span class="at">--step</span> qc <span class="at">-t</span> lesion <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
</section>
<section id="step-3.-post-qc" class="level4">
<h4 class="anchored" data-anchor-id="step-3.-post-qc"><u>Step 3. Post-QC</u></h4>
<p>This step allows for reviewing QC results in the app.</p>
<p><br> <u>Required flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-m or --mainpath</span>: path to parent data folder<br> <span style="font-family:menlo; color:black; font-size:16px;">--step</span>: step of pipeline - prep, qc, post. Default is prep. This step is qc<br> <span style="font-family:menlo; color:black; font-size:16px;">--toolpath</span>: path to pipeline folder<br></p>
<p><u>Other flags:</u></p>
<p><span style="font-family:menlo; color:black; font-size:16px;">-c or --container</span>: which container to use: singularity, docker, local, cluster. Default is cluster<br> <span style="font-family:menlo; color:black; font-size:16px;">--sinpath</span>: path to singularity image (only needed if using singularity container - don’t need to specify if using takim cluster)<br> <span style="font-family:menlo; color:black; font-size:16px;">--dockerpath</span>: path to docker image (only needed if using docker container)<br> <span style="font-family:menlo; color:black; font-size:16px;">--cores</span>: number of cores used for parallel computing. Default is 1<br> <span style="font-family:menlo; color:black; font-size:16px;">-h or --help</span>: show help message<br> <br></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /path/to/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /path/to/data <span class="at">--step</span> post <span class="at">--toolpath</span> /path/to/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For example:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bash</span> /home/ehorwath/projects/PennSIVE_neuro_pip/pipelines/BrainQC/code/bash/QC.sh <span class="at">-m</span> /home/ehorwath/projects/mscamras_defaced_regSites <span class="at">--step</span> post <span class="at">--toolpath</span> /home/ehorwath/projects/PennSIVE_neuro_pip </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> <br></p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>